cd C:\Users\moshe\automation-builder

# ×‘×•×—×¨×™× ×‘×¨×× ×¥' ×§×‘×•×¢ ×œ×©×™×’×•×¨ (××¤×©×¨ ×œ×©× ×•×ª ××ª ×”×©× ×× ×ª×¨×¦×”)
$BRANCH = "deploy"

# ××©×™×›×ª ×¨×¤×¨× ×¡×™× ××”×©×¨×ª
git fetch origin | Out-Null

# ××¢×‘×¨/×™×¦×™×¨×” ×©×œ ×”×‘×¨×× ×¥'
git switch -C $BRANCH

# ×× ×™×© origin/$BRANCH × ×¨×‘×™×™×¡ ×¢×œ×™×•, ××—×¨×ª × ×¨×‘×™×™×¡ ×¢×œ origin/main (×× ×§×™×™×)
$exists = git ls-remote --exit-code origin $BRANCH *> $null; $exists = ($LASTEXITCODE -eq 0)
if ($exists) { git pull --rebase origin $BRANCH } else { git pull --rebase origin main 2>$null }

# ×× ×¡×™× ×œ×©×’×¨ ×©×™× ×•×™×™×
git add -A
git diff --cached --quiet
if ($LASTEXITCODE -eq 0) {
  Write-Host "âœ” ××™×Ÿ ××” ×œ×©×’×¨ (No changes)."
} else {
  git commit -m "update: $(Get-Date -Format s)"
  git push -u origin $BRANCH
  Write-Host "ğŸš€ ×©×•×’×¨ ×œ-$BRANCH"
}
